{% extends "catalog/base.html" %}

{% block content %}
<form method="post" enctype="multipart/form-data">
    <div class="container mt-5">
        <div class="row mb-5">
            <div class="col-12">
                <div class="row">
                    <!-- Колонка с формой продукта -->
                    <div class="col-6">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <p>Добавление продукта</p>
                                </h3>
                            </div>
                            <div class="card-body">
                                {% csrf_token %}
                                {{ form.as_p }}
                                <button type="submit" class="btn btn-success">
                                    {% if object %}
                                    Сохранить
                                    {% else %}
                                    Создать
                                    {% endif %}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Колонка с изображением продукта -->
                    <div class="col-6">
                        <div class="card" style="height: 100%;">
                            <div class="card-body d-flex align-items-center justify-content-center"
                                 style="height: 100%;">
                                {% if object and object.image %}
                                <img src="{{ object.image.url }}" class="img-fluid" alt="Product Image"
                                     style="max-height: 100%; max-width: 100%; object-fit: contain;">
                                {% else %}
                                <p>Нет изображения</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Колонка с версиями продукта -->
                    <div class="col-12 mt-4">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <p>Добавление версий</p>
                                </h3>
                            </div>
                            <div class="card-body">
                                {{ formset.management_form }}

                                <div class="d-flex flex-column align-items-start">
                                    <!-- Отображение каждой версии в отдельной карточке -->
                                    {% for form in formset.forms %}
                                    <div class="card mb-3 version-card">
                                        <div class="card-header">
                                            <h5>Версия {{ forloop.counter }}</h5>
                                        </div>
                                        <div class="card-body">
                                            {{ form.as_p }}
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="card-footer"></div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</form>
{% endblock %}
